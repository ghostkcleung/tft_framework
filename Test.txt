Here is an example C function that can convert WGS84 coordinates to HK1980 grid system:

```c
#include

#define PI 3.14159265358979323846
#define a 6378137.0
#define b 6356752.31414
#define f (a - b) / a
#define e sqrt(2 * f - f * f)

void WGS84toHK1980(double lat, double lon, double *x, double *y) {
double lat_rad = lat * PI / 180.0;
double lon_rad = lon * PI / 180.0;
double N = a / sqrt(1 - e * e * sin(lat_rad) * sin(lat_rad));
double M = a * (1 - e * e) / pow(1 - e * e * sin(lat_rad) * sin(lat_rad), 1.5);
double t = tan(lat_rad);
double eta = e * cos(lat_rad);
double p = lon_rad - 114.1785555916667 * PI / 180.0;
double A = a * (1 - e * e) * (1 + 3 * e * e / 4 + 45 * pow(e, 4) / 64 + 175 * pow(e, 6) / 256 + 11025 * pow(e, 8) / 16384) / pow(1 - e * e, 2);
double B = a * (1 - e * e) * (3 * e * e / 4 + 15 * pow(e, 4) / 16 + 525 * pow(e, 6) / 512 + 2205 * pow(e, 8) / 2048) / pow(1 - e * e, 2);
double C = a * (1 - e * e) * (15 * pow(e, 4) / 64 + 105 * pow(e, 6) / 256 + 2205 * pow(e, 8) / 4096) / pow(1 - e * e, 2);
double D = a * (1 - e * e) * (35 * pow(e, 6) / 512 + 315 * pow(e, 8) / 2048) / pow(1 - e * e, 2);
double E = a * (1 - e * e) * (315 * pow(e, 8) / 131072) / pow(1 - e * e, 2);
double X = A * lat_rad - B * sin(2 * lat_rad) + C * sin(4 * lat_rad) - D * sin(6 * lat_rad) + E * sin(8 * lat_rad);
double Y = N * (p + p * p * p / 6 * pow(cos(lat_rad), 2) * (N / M) * (N / M) * (1 - t * t + eta * eta) + p * p * p * p * p / 120 * pow(cos(lat_rad), 4) * (N / M) * (N / M) * (5 - 18 * t * t + pow(t, 4) + 14 * eta * eta - 58 * t * t * eta * eta));
*x = X + 836694.05;
*y = Y + 819069.80;
}
```

This function takes in the latitude and longitude of a point in WGS84 coordinates and returns the corresponding HK1980 grid system coordinates in the `x` and `y` variables. The constants `a`, `b`, `f`, and `e` are the parameters of the WGS84 ellipsoid. The constants `A`, `B`, `C`, `D`, and `E` are the coefficients of the latitude formula for HK1980. The function uses these formulas to calculate the X and Y coordinates of the point in HK1980 coordinates, and then adds the offset values of 836694.05 and 819069.80 to get the final coordinates.

Note that this function assumes that the input latitude and longitude are in decimal degrees, and that the output coordinates are in meters. Also, this function only works for the Hong Kong area, and may not be accurate for other regions.
